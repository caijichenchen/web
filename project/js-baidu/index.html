<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>仿百度注册</title>
	<style>
		*{
			margin: 0;
			padding: 0;
		}
		header{
			margin-left: auto;
			margin-right: auto;
			background-image: url(image/head.png);
			background-size: 100%;
			height: 75px;
		}
		.wrap{
			width: 980px;
			height: 395px;
			margin-left: auto;
			margin-right: auto;
		}
		.wrap div{
			position: relative;
			margin-bottom: 20px;
		}
		.wrap div:after{
			content: "";
            clear: both;
            display: block;
            visibility: hidden;
            height: 0;
		}
		label{
			color: #666;
			font-size: 14px;
			width: 65px;
			height: 42px;
			margin-right: 10px;
			font-weight: bolder;
			line-height: 42px;
			text-align: right;
			float: left;
			display: block;
		}
		input{
			/*display: block;*/
			border: 1px solid #ddd;
			box-sizing: border-box;
			float: left;
			padding-left: 14px;
			width: 328px;
			height: 42px;
			line-height: 42px;
			margin-right: 10px;
		}
		#verify-box input:nth-of-type(1){
             width: 158px;
        }
        #verify-box input:nth-of-type(2){
            width: 160px;            
            height: 40px;
            border-radius: 0;            
            background: #f7f7f7;
            font-weight: 400;
            text-align: center;
            cursor: pointer;
            padding-left: -14px;
            color: #666;
        }
        #agree-box input{
            width: 15px;
            margin-top: -12px;
            /*display: inline;*/
        }
        /*
		#txt{
			width: 158px;
			height: 40px;
			margin-right: 10px;
			float: left;
		}*/
		#rdbtn{
			height: 50px;
			font-size: 16px;
			color: #fff;
			background-color: #4490f7;
			cursor: pointer;
			font-weight: 700;
			width: 330px;
			border-radius: 3px;
			border: 1px solid #4490f7;
			margin-top: -10px;
		}
		#user-box{
			margin-top: 40px;
		}
		#agree-box{
			font-size: 12px;
		}
		#agree-box a{
			font-size: 12px;
			text-decoration: none;
			display: inline;
		}
		.cancel{
			background: url(image/all.png) -48px -24px no-repeat;
			width: 16px;
			height: 16px;
			/*display: inline-block;*/
			cursor: pointer;
			position: absolute;
			top: 12px;
			left: 378px;
			float: left;
		}
		.focuss{
			height: 40px;
			line-height: 40px;
			color: #666;
			font-size: 12px;
		}
		#user-box .focuss{
			line-height: 18px;
		}
		#verify-box .cancel{
			left: 208px;
		}
		#pwdChecklist{
            position: absolute;
            top: 0;
            left: 420px;
            width: 200px;
            padding: 5px 10px;
            border: 1px solid #ddd;
            box-shadow: 1px 1px 1px #efefef;
            background: #f9f9f9;
            font-size: 12px;
        }
        .pwd-checklist li{
            list-style: none;
        }
        .pwd-checklist .pwd-checklist-item-success {
            background-position: -86px -128px;
        }
        .pwd-checklist  .pwd-checklist-item-error {
            color: rgb(252, 67, 67);
            background-position: -86px -144px;
        }
        .pwd-checklist-item {
            line-height: 20px;
            padding-left: 18px;
            background: url(image/all.png) no-repeat -86px -112px;
            color: #666;
        }
        .pwd-checklist-arrow{
            position: absolute;
            top: 12px;
            left: -7px;            
            width: 14px;
            height: 14px;
            background: #f9f9f9;
            border-bottom: 1px solid #ddd;
            border-left: 1px solid #ddd; 
            transform: rotateZ(45deg);                  
        }
        .error{
        	background: url(image/all.png) -80px -23px no-repeat;
            font-size: 12px;
            color: #fc4343; 
            position: relative;
            top: 8px;  
            padding-left: 20px;
        }
        .input-error{
        	border-color: #f00;
        }
        .rights{
        	background: url(image/all.png) -80px 0 no-repeat;
            font-size: 12px;
            position: relative;
            top: 8px;  
            padding-left: 20px;
        }
        .agreeerr{
			background: url(image/all.png) -80px -23px no-repeat;
            font-size: 12px;
            color: #fc4343; 
            position: relative;
            top: 8px;  
            padding-left: 20px;
            display: none;
        }
        .sp{
        	margin-right: 5px;
        }
	</style>
</head>
<body>
	<header></header>
	<section>
		<div class="content">
			<div class="wrap">
				<form action="https://www.baidu.com">
					<div id="user-box">
						<label for="username">用户名</label>
						<input class="txt" type="text" autocomplete="off" id="username" name="username" placeholder="请设置用户名">
						<span class="cancel" style="display:none"></span>
						<span msg="msg"></span>
					</div>
					<div id="iphone-box">
						<label for="iphone">手机号</label>
						<input class="txt" type="text" autocomplete="off" name="iphone" placeholder="可用来登陆和找回密码">
						<span class="cancel" style="display: none"></span>
						<span msg="msg"></span>
					</div>
					<div id="word-box">
						<label for="password">密码</label>
						<input class="txt" type="password" autocomplete="off" name="password" placeholder="请设置登陆密码">
						<span class="cancel" style="display: none"></span>
						<span msg="msg"></span>
						<div id="pwdChecklist" class="pwd-checklist" style="display: none">
	                        <ul>
	                            <li class="pwd-checklist-item">长度为8~14个字符</li>
	                            <li class="pwd-checklist-item">支持数字,大小写字母和标点符号</li>
	                            <li class="pwd-checklist-item ">不允许有空格</li>
	                        </ul>
	                        <span class="pwd-checklist-arrow"></span>
	                    </div>
					</div>
					<div id="verify-box">
						<label for="verify">验证码</label>
						<input class="txt" id="txt" type="text" autocomplete="off" name="verify" placeholder="请输入验证码">

						<span class="cancel" style="display: none"></span>

						<input type="button" id="getbtn" value="获取短信验证码">
						<span class="msg"></span>
					</div>
					<div id="agree-box">
						<label for=""></label>
						<input type="checkbox" name="agree">
						<span class="sp">阅读并接受</span>
						<a href="#">《百度用户协议》</a>及<a href="#">《百度隐私权保护声明》</a>
	                    <span class="agreeerr">请勾选“阅读并接受百度用户协议”</span> 
					</div>
					<div id="registered">
						<label for=""></label>
						<button id="rdbtn">注册</button>
					</div>
				</form>
			</div>
		</div>
	</section>
</body>
<script>
	//共同函数
	function getLen(str){
		return str.replace(/[\u4e00-\u9fa5]/g,"aa").length;
	}

	function changeErr(oSpan,sMsg,oInput){
		oSpan.innerHTML = sMsg;
		oSpan.className = "error";
		oInput.className = "input-error";
	}

	function changeRh(oSpan,oInput){
		oSpan.innerHTML = "";
		oSpan.className = "rights";
		oInput.className = "";
	}

	//1.获取元素
	var oForm = document.forms[0];
	var oUsername = oForm.username;
	var oIphone = oForm.iphone;
	var oPassword = oForm.password;
	var oVerify = oForm.verify;
	var oAgree = oForm.agree;
	var oBtn = document.getElementById('rdbtn');
	var oBtno = document.getElementById('getbtn');
	var oAgreeErr = document.getElementById('agreeErr');
	var aSpan = document.querySelectorAll('span');
	var oChecklist = document.getElementById('pwdChecklist');
	var oList = oChecklist.querySelectorAll('.pwd-checklist-item');


	//2.初始化
	function loadUser(){
		oUsername.focus();
		aSpan[1].innerHTML = "设置后不可更改<br>中英文均可,最多14个英文或者七个汉字";
		aSpan[1].className = "focuss";

		//利用事件冒泡监听输入事件
		oForm.oninput = function(ev){
			var oEvent = ev || window.event;
			var oInput = oEvent.target;
			var aCancel = oInput.nextElementSibling;
			var l = oInput.value.length;
			console.log(l)
			if(l > 0){
				aCancel.style.display = "block";
			}else{
				aCancel.style.display = "none";
			}
		}
		//利用事件委托处理删除按钮
		oForm.onclick = function(ev){
			var aCancel = ev.target;
			var oInput = aCancel.previousElementSibling;
			if(oInput){
				if(oInput.name == "username" || oInput.name == "iphone" ||
					oInput.name == "password" || oInput.name == "verify"){
					oInput.value = "";
					oInput.focus();

					aSpan[1].innerHTML = "设置后不可更改<br>中英文均可,最多14个英文或者七个汉字";
					aSpan[1].className = "focuss";
					aCancel.style.display = "none";
				}
			}
		}
	}
	loadUser();

	//3.监听输入事件按钮
	/*
	oUsername.oninput = function(){
		var l = oUsername.value.length;
		if(l > 0){
			aSpan[0].style.display = "block";
		}else{
			aSpan[0].style.display = "none";
		}
	}
	*/
	//4.点击取消按钮回到初始界面
	/*
	aSpan[0].onclick = function(){
		
	}
	*/
	//5.失去焦点验证用户名
	function focusUser(){
		oUsername.onblur = function(){
			vUser = false;
			var iVal = oUsername.value;
			var reg3 = /[^a-z\u4e00-\u9fa5_\d]/i;
			var reg2 = /^\d+$/g;
			//全是空白符
			var reg1 = /^\s+$/;
			//什么都没有输入

			if(iVal == ""){
				aSpan[1].style.display = "none";
			}
			else if(reg1.test(iVal)){
				/*
				aSpan[1].innerHTML = "用户名输入不规范";
				aSpan[1].className = "error";
				oUsername.className = "input-error";
				*/
				changeErr(aSpan[1],"用户名输入不规范",oUsername);
				console.log(aSpan[1])
			}
			else if(getLen(iVal) > 14){
				/*
				aSpan[1].innerHTML = "用户名不能超过七个汉字或14个字符";
				aSpan[1].className = "error";
				oUsername.className = "input-error";
				*/
				changeErr(aSpan[1],"用户名不能超过七个汉字或14个字符",oUsername);
			}
			else if(reg3.test(iVal) || reg2.test(iVal)){
				/*
				aSpan[1].innerHTML = "用户名仅支持中英文、数字和下划线,且不能为纯数字";
				aSpan[1].className = "error";
				oUsername.className = "input-error";
				*/
				changeErr(aSpan[1],"用户名仅支持中英文、数字和下划线,且不能为纯数字",oUsername);
			}
			else{
				/*
				aSpan[1].innerHTML = "";
				aSpan[1].className = "rights";
				oUsername.className = "";
				*/
				// aSpan[1].style.display = "block";
				changeRh(aSpan[1],oUsername);
				vUser = true;
			}
			// oUsername.value = "";
		}

		//获取焦点再处理
		oUsername.onfocus = function(){
			aSpan[1].innerHTML = "设置后不可更改<br>中英文均可,最多14个英文或者七个汉字";
			aSpan[1].className = "focuss";
			oUsername.className = "";
		}

		/*oUsername.onfocus = function(){
			aSpan[1].innerHTML = "设置后不可更改<br>中英文均可,最多14个英文或者七个汉字";
			aSpan[1].className = "focuss";
		}*/

		/*oIphone.onfocus = function(){
			aSpan[3].style.display = "inline-block";
			aSpan[3].innerHTML = "请输入中国大陆手机号,其他用户不可见";
			aSpan[3].style.color = "#666";
			aSpan[3].style.fontSize = "12px";
			aSpan[3].style.marginTop = "14px";
		}

		oPassword.onfocus = function(){
			// aSpan[4].style.display = "block";
			oChecklist.style.display = "block";
		}

		oVerify.onfocus = function(){
			// aSpan[7].style.display = "block";
		}*/
	}
	focusUser();

	//6.验证手机号
	function focusPhone(){
		oIphone.onblur = function(){
			vPhone = false;
			var iVal = oIphone.value;
			var reg2 = /^1[35789]\d{9}/;
			//全是空白符
			var reg1 = /^\s+$/;
			//什么都没有输入
			if(iVal == ""){
				aSpan[3].style.display = "none";
			}
			else if(reg1.test(iVal)){
				changeErr(aSpan[3],"请输入正确的手机号",oIphone);
			}
			else if(!reg2.test(iVal)){
				changeErr(aSpan[3],"手机号格式不正确",oIphone);
			}
			else{
				console.log(11)
				changeRh(aSpan[3],oIphone);
				vPhone = true;
			}
		}

		//获取焦点再处理
		oIphone.onfocus = function(){
			aSpan[3].innerHTML = "请输入中国大陆手机号";
			aSpan[3].className = "focuss";
			oIphone.className = "";
		}
	}
	focusPhone();

	//7.密码验证实时
	function checkPassword(){
		oPassword.onfocus = function(){
			oChecklist.style.display = "block";
			// aSpan[5].style.display = "none";
		}
		//密码实时验证
		oPassword.oninput = function(){
			// oChecklist.style.display = "block";
			//获取输入框的值
			vPwd = false;
			bPwd1 = false;
			bPwd2 = false;
			bPwd3 = false;
			var iVal = oPassword.value;
			//长度为8~14个字符
			var reg1 = /^.{8,14}$/;
			//支持数字,大小写字母和标点符号
			var reg2 = /[^0-9a-z\!\*\.\s]/i;
			//不允许有空格
			var reg3 = /\s/;

			if(!reg1.test(iVal)){
				oList[0].className = "pwd-checklist-item  pwd-checklist-item-error";
				bPwd1 = false;
			}else{
				oList[0].className = "pwd-checklist-item  pwd-checklist-item-success";
				bPwd1 = true;
			}

			if(reg2.test(iVal)){
				oList[1].className = "pwd-checklist-item  pwd-checklist-item-error";
				bPwd2 = false;
			}else{
				oList[1].className = "pwd-checklist-item  pwd-checklist-item-success";
				bPwd2 = true;
			}

			if(reg3.test(iVal)){
				oList[2].className = "pwd-checklist-item  pwd-checklist-item-error";
				bPwd3 = false;
			}else{
				oList[2].className = "pwd-checklist-item  pwd-checklist-item-success";
				bPwd3 = true;
			}
		}
		//输入框置空
		oPassword.onblur = function(){
			if(oPassword.value == ""){
				oChecklist.style.display = "none";
			}
			else if(bPwd1 && bPwd2 && bPwd3){
				oChecklist.style.display = "none";
				console.log(22);
				changeRh(aSpan[5],oPassword);
				vPwd = true;
			}
		}

	}
	checkPassword();

	//8.验证码验证
	function checkVerify(){
		var iVal = oIphone.value;
		//点击获取验证码
		oBtno.onclick = function(){
			if(oIphone.value == ""){
				changeErr(aSpan[8],"请输入正确的手机号",oIphone);
				return false;
			}
			if(!vPhone){
				return false;
			}
			alert("获取验证码中");
		}
		//验证验证码
		oVerify.onblur = function(){
			voVerify = false;
			var iVal = oVerify.value;
			var reg = /^[0-9a-z]{6}$/;
			//什么都没有输入
			if(iVal == ""){
				aSpan[7].style.display = "none";
			}
			//验证码验证
			else if(!reg.test(iVal)){
				changeErr(aSpan[8],"验证码输入不正确",oVerify);
			}else{
				changeRh(aSpan[8],oVerify);
				voVerify = true;
			}
			
		}
		//限制验证码长度
		oVerify.onkeydown = function(ev){
			// console.log(11)
			console.log(oVerify.value.length)
			if(oVerify.value.length > 5 && ev.keyCode != 8 && ev.keyCode != 37 && ev.keyCode != 39){
                return false;
            }
		}
	}
	checkVerify();

	//9.提交验证
	function focusoAgree(){
		oBtn.onclick = function(){
			if(oUsername.value == ""){
				changeErr(aSpan[1],"请输入正确的用户名",oUsername);
			}
			if(oIphone.value == ""){
				changeErr(aSpan[3],"请输入正确的手机号",oIphone);
			}
			if(oPassword.value == ""){
				changeErr(aSpan[5],"请输入正确的密码",oPassword);
			}
			if(oVerify.value == ""){
				changeErr(aSpan[8],"请输入正确的验证码",oVerify);
			}
			if(!oAgree.checked){
				oAgreeErr.style.display = "inline";
			}else{
				oAgreeErr.style.display = "none";
			}

			if(vUser && vPhone && vPwd && voVerify && oAgree.checked){
				oForm.submit();
			}
		}
	}
	focusoAgree();
</script>
</html>